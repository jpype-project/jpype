os:
  - linux

language: python

python:
  - 'nightly'
  - 'pypy3'

env:
  global:
    - PYTHON=python
    - PIP=pip
    - INST=""

matrix:
  allow_failures:
    - python: nightly
    - python: pypy3

  include:

    - name: "Python on macOS xcode 11.3"
      os: osx
      osx_image: xcode11.3
      language: java
      env:
        - PYTHON=python3
        - INST=--user
        - PIP=pip3
      install:
        - echo $PYTHON $INST
        - $PYTHON setup.py sdist
        - $PIP install $INST dist/* $NUMPY
        - $PIP install $INST -r test-requirements.txt
        - $PYTHON setup.py test_java


install:
  - echo $PYTHON $INST
  - $PYTHON setup.py sdist
  - $PIP install $INST dist/* $NUMPY
  - $PIP install $INST -r test-requirements.txt
  - $PYTHON setup.py test_java

script:
  - $PYTHON -c "import jpype"
  - $PYTHON -m pytest -v test/jpypetest --checkjni

